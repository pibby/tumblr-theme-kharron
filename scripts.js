(function($,window,document,undefined){var pluginName="photosetGrid",defaults={width:"100%",gutter:"0px",highresLinks:false,lowresWidth:500,rel:"",onInit:function(){},onComplete:function(){}};function Plugin(element,options){this.element=element;this.options=$.extend({},defaults,options);this._defaults=defaults;this._name=pluginName;this.init()}Plugin.prototype={init:function(){this.options.onInit();this._setupRows(this.element,this.options);this._setupColumns(this.element,this.options)},_callback:function(){this.options.onComplete()},_setupRows:function(elem,options){if(options.layout){this.layout=options.layout}else{if($(elem).attr("data-layout")){this.layout=$(elem).attr("data-layout")}else{var stackedLayout="";var defaultColumns=1;for(var imgs=0;imgs<$(elem).find("img").length;imgs++){stackedLayout=stackedLayout+defaultColumns.toString()}this.layout=stackedLayout}}this.rows=this.layout.split("");for(var i in this.rows){this.rows[i]=parseInt(this.rows[i],10)}var $images=$(elem).find("img");var imageIndex=0;$.each(this.rows,function(i,val){var rowStart=imageIndex;var rowEnd=imageIndex+val;$images.slice(rowStart,rowEnd).wrapAll('<div class="photoset-row cols-'+val+'"></div>');imageIndex=rowEnd});$(elem).find(".photoset-row:not(:last-child)").css({"margin-bottom":options.gutter})},_setupColumns:function(elem,options){var $this=this;var setupStyles=function(){var $rows=$(elem).find(".photoset-row");var $images=$(elem).find("img");if(options.highresLinks){$images.each(function(){var highres;if($(this).attr("data-highres")){highres=$(this).attr("data-highres")}else{highres=$(this).attr("src")}$(this).wrapAll('<a href="'+highres+'" class="photoset-cell highres-link" />')});if(options.rel){$images.parent().attr("rel",options.rel)}}else{$images.each(function(){$(this).wrapAll('<div class="photoset-cell" />')})}var $cells=$(elem).find(".photoset-cell");var $cols1=$(elem).find(".cols-1 .photoset-cell");var $cols2=$(elem).find(".cols-2 .photoset-cell");var $cols3=$(elem).find(".cols-3 .photoset-cell");var $cols4=$(elem).find(".cols-4 .photoset-cell");var $cols5=$(elem).find(".cols-5 .photoset-cell");$(elem).css({width:options.width});$rows.css({clear:"left",display:"block",overflow:"hidden"});$cells.css({"float":"left",display:"block","line-height":"0","-webkit-box-sizing":"border-box","-moz-box-sizing":"border-box","box-sizing":"border-box"});$images.css({width:"100%",height:"auto"});$cols1.css({width:"100%"});$cols2.css({width:"50%"});$cols3.css({width:"33.3%"});$cols4.css({width:"25%"});$cols5.css({width:"20%"});var gutterVal=parseInt(options.gutter,10);$(elem).find(".photoset-cell:not(:last-child)").css({"padding-right":(gutterVal/2)+"px"});$(elem).find(".photoset-cell:not(:first-child)").css({"padding-left":(gutterVal/2)+"px"});function resizePhotosetGrid(){var w=$(elem).width().toString();if(w!==$(elem).attr("data-width")){$rows.each(function(){var $shortestImg=$(this).find("img:eq(0)");$(this).find("img").each(function(){var $img=$(this);if($img.height()<$shortestImg.height()){$shortestImg=$(this)}if($img.width()>options.lowresWidth&&$img.attr("data-highres")){$img.attr("src",$img.attr("data-highres"))}});var rowHeight=$shortestImg.height();var bufferHeight=Math.floor(rowHeight*0.025);$(this).height(rowHeight-bufferHeight);$(this).find("img").each(function(){var marginOffset=((rowHeight-$(this).height())*0.5)+"px";$(this).css({"margin-top":marginOffset})})});$(elem).attr("data-width",w)}}resizePhotosetGrid();$(window).on("resize",function(){resizePhotosetGrid()})};$(elem).imagesLoaded(function(){setupStyles();$this._callback()})}};$.fn[pluginName]=function(options){return this.each(function(){if(!$.data(this,"plugin_"+pluginName)){$.data(this,"plugin_"+pluginName,new Plugin(this,options))}})};
/*!
     * jQuery imagesLoaded plugin v2.1.1
     * http://github.com/desandro/imagesloaded
     *
     * MIT License. by Paul Irish et al.
     */
var BLANK="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==";$.fn.imagesLoaded=function(callback){var $this=this,deferred=$.isFunction($.Deferred)?$.Deferred():0,hasNotify=$.isFunction(deferred.notify),$images=$this.find("img").add($this.filter("img")),loaded=[],proper=[],broken=[];if($.isPlainObject(callback)){$.each(callback,function(key,value){if(key==="callback"){callback=value}else{if(deferred){deferred[key](value)}}})}function doneLoading(){var $proper=$(proper),$broken=$(broken);if(deferred){if(broken.length){deferred.reject($images,$proper,$broken)}else{deferred.resolve($images)}}if($.isFunction(callback)){callback.call($this,$images,$proper,$broken)}}function imgLoadedHandler(event){imgLoaded(event.target,event.type==="error")}function imgLoaded(img,isBroken){if(img.src===BLANK||$.inArray(img,loaded)!==-1){return}loaded.push(img);if(isBroken){broken.push(img)}else{proper.push(img)}$.data(img,"imagesLoaded",{isBroken:isBroken,src:img.src});if(hasNotify){deferred.notifyWith($(img),[isBroken,$images,$(proper),$(broken)])}if($images.length===loaded.length){setTimeout(doneLoading);$images.unbind(".imagesLoaded",imgLoadedHandler)}}if(!$images.length){doneLoading()}else{$images.bind("load.imagesLoaded error.imagesLoaded",imgLoadedHandler).each(function(i,el){var src=el.src;var cached=$.data(el,"imagesLoaded");if(cached&&cached.src===src){imgLoaded(el,cached.isBroken);return}if(el.complete&&el.naturalWidth!==undefined){imgLoaded(el,el.naturalWidth===0||el.naturalHeight===0);return}if(el.readyState||el.complete){el.src=BLANK;el.src=src}})}return deferred?deferred.promise($this):$this};var $event=$.event,$special,dummy={_:0},frame=0,wasResized,animRunning;$special=$event.special.throttledresize={setup:function(){$(this).on("resize",$special.handler)},teardown:function(){$(this).off("resize",$special.handler)},handler:function(event,execAsap){var context=this,args=arguments;wasResized=true;if(!animRunning){setInterval(function(){frame++;if(frame>$special.threshold&&wasResized||execAsap){event.type="throttledresize";$event.dispatch.apply(context,args);wasResized=false;frame=0}if(frame>9){$(dummy).stop();animRunning=false;frame=0}},30);animRunning=true}},threshold:0}})(jQuery,window,document);window.Rainbow=function(){function q(a){var b,c=a.getAttribute&&a.getAttribute("data-language")||0;if(!c){a=a.attributes;for(b=0;b<a.length;++b){if("data-language"===a[b].nodeName){return a[b].nodeValue}}}return c}function B(a){var b=q(a)||q(a.parentNode);if(!b){var c=/\blang(?:uage)?-(\w+)/;(a=a.className.match(c)||a.parentNode.className.match(c))&&(b=a[1])}return b}function C(a,b){for(var c in f[d]){c=parseInt(c,10);if(a==c&&b==f[d][c]?0:a<=c&&b>=f[d][c]){delete f[d][c],delete j[d][c]}if(a>=c&&a<f[d][c]||b>c&&b<f[d][c]){return !0}}return !1}function r(a,b){return'<span class="'+a.replace(/\./g," ")+(l?" "+l:"")+'">'+b+"</span>"}function s(a,b,c,i){var e=a.exec(c);if(e){++t;!b.name&&"string"==typeof b.matches[0]&&(b.name=b.matches[0],delete b.matches[0]);var k=e[0],g=e.index,u=e[0].length+g,h=function(){function e(){s(a,b,c,i)}t%100>0?e():setTimeout(e,0)};if(C(g,u)){h()}else{var m=v(b.matches),l=function(a,c,i){if(a>=c.length){i(k)}else{var d=e[c[a]];if(d){var g=b.matches[c[a]],f=g.language,h=g.name&&g.matches?g.matches:g,j=function(b,d,g){var f;f=0;var h;for(h=1;h<c[a];++h){e[h]&&(f=f+e[h].length)}d=g?r(g,d):d;k=k.substr(0,f)+k.substr(f).replace(b,d);l(++a,c,i)};f?n(d,f,function(a){j(d,a)}):typeof g==="string"?j(d,d,g):w(d,h.length?h:[h],function(a){j(d,a,g.matches?g.name:0)})}else{l(++a,c,i)}}};l(0,m,function(a){b.name&&(a=r(b.name,a));if(!j[d]){j[d]={};f[d]={}}j[d][g]={replace:e[0],"with":a};f[d][g]=u;h()})}}else{i()}}function v(a){var b=[],c;for(c in a){a.hasOwnProperty(c)&&b.push(c)}return b.sort(function(a,b){return b-a})}function w(a,b,c){function i(b,k){k<b.length?s(b[k].pattern,b[k],a,function(){i(b,++k)}):D(a,function(a){delete j[d];delete f[d];--d;c(a)})}++d;i(b,0)}function D(a,b){function c(a,b,i,f){if(i<b.length){++x;var h=b[i],l=j[d][h],a=a.substr(0,h)+a.substr(h).replace(l.replace,l["with"]),h=function(){c(a,b,++i,f)};0<x%250?h():setTimeout(h,0)}else{f(a)}}var i=v(j[d]);c(a,i,0,b)}function n(a,b,c){var d=m[b]||[],e=m[y]||[],b=z[b]?d:d.concat(e);w(a.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/&(?![\w\#]+;)/g,"&amp;"),b,c)}function o(a,b,c){if(b<a.length){var d=a[b],e=B(d);return !(-1<(" "+d.className+" ").indexOf(" rainbow "))&&e?(e=e.toLowerCase(),d.className+=d.className?" rainbow":"rainbow",n(d.innerHTML,e,function(k){d.innerHTML=k;j={};f={};p&&p(d,e);setTimeout(function(){o(a,++b,c)},0)})):o(a,++b,c)}c&&c()}function A(a,b){var a=a&&"function"==typeof a.getElementsByTagName?a:document,c=a.getElementsByTagName("pre"),d=a.getElementsByTagName("code"),e,f=[],g=[];for(e=0;e<c.length;++e){c[e].getElementsByTagName("code").length?c[e].innerHTML=c[e].innerHTML.replace(/^\s+/,"").replace(/\s+$/,""):f.push(c[e])}for(e=0;e<d.length;++e){g.push(d[e])}o(g.concat(f),0,b)}var j={},f={},m={},z={},d=0,y=0,t=0,x=0,l,p;return{extend:function(a,b,c){1==arguments.length&&(b=a,a=y);z[a]=c;m[a]=b.concat(m[a]||[])},b:function(a){p=a},a:function(a){l=a},color:function(a,b,c){if("string"==typeof a){return n(a,b,c)}if("function"==typeof a){return A(0,a)}A(a,b)}}}();document.addEventListener?document.addEventListener("DOMContentLoaded",Rainbow.color,!1):window.attachEvent("onload",Rainbow.color);Rainbow.onHighlight=Rainbow.b;Rainbow.addClass=Rainbow.a;Rainbow.extend("html",[{name:"source.php.embedded",matches:{2:{language:"php"}},pattern:/&lt;\?=?(?!xml)(php)?([\s\S]*?)(\?&gt;)/gm},{name:"source.css.embedded",matches:{"0":{language:"css"}},pattern:/&lt;style(.*?)&gt;([\s\S]*?)&lt;\/style&gt;/gm},{name:"source.js.embedded",matches:{"0":{language:"javascript"}},pattern:/&lt;script(?! src)(.*?)&gt;([\s\S]*?)&lt;\/script&gt;/gm},{name:"comment.html",pattern:/&lt;\!--[\S\s]*?--&gt;/g},{matches:{1:"support.tag.open",2:"support.tag.close"},pattern:/(&lt;)|(\/?\??&gt;)/g},{name:"support.tag",matches:{1:"support.tag",2:"support.tag.special",3:"support.tag-name"},pattern:/(&lt;\??)(\/|\!?)(\w+)/g},{matches:{1:"support.attribute"},pattern:/([a-z-]+)(?=\=)/gi},{matches:{1:"support.operator",2:"string.quote",3:"string.value",4:"string.quote"},pattern:/(=)('|")(.*?)(\2)/g},{matches:{1:"support.operator",2:"support.value"},pattern:/(=)([a-zA-Z\-0-9]*)\b/g},{matches:{1:"support.attribute"},pattern:/\s(\w+)(?=\s|&gt;)(?![\s\S]*&lt;)/g}],!0);Rainbow.extend("css",[{name:"comment",pattern:/\/\*[\s\S]*?\*\//gm},{name:"constant.hex-color",pattern:/#([a-f0-9]{3}|[a-f0-9]{6})(?=;|\s)/gi},{matches:{1:"constant.numeric",2:"keyword.unit"},pattern:/(\d+)(px|em|cm|s|%)?/g},{name:"string",pattern:/('|")(.*?)\1/g},{name:"support.css-property",matches:{1:"support.vendor-prefix"},pattern:/(-o-|-moz-|-webkit-|-ms-)?[\w-]+(?=\s?:)(?!.*\{)/g},{matches:{1:[{name:"entity.name.sass",pattern:/&amp;/g},{name:"direct-descendant",pattern:/&gt;/g},{name:"entity.name.class",pattern:/\.[\w\-_]+/g},{name:"entity.name.id",pattern:/\#[\w\-_]+/g},{name:"entity.name.pseudo",pattern:/:[\w\-_]+/g},{name:"entity.name.tag",pattern:/\w+/g}]},pattern:/([\w\ ,:\.\#\&\;\-_]+)(?=.*\{)/g},{matches:{2:"support.vendor-prefix",3:"support.css-value"},pattern:/(:|,)\s?(-o-|-moz-|-webkit-|-ms-)?([a-zA-Z-]*)(?=\b)(?!.*\{)/g},{matches:{1:"support.tag.style",2:[{name:"string",pattern:/('|")(.*?)(\1)/g},{name:"entity.tag.style",pattern:/(\w+)/g}],3:"support.tag.style"},pattern:/(&lt;\/?)(style.*?)(&gt;)/g}],!0);